{"mappings":";AAqGA;gBA0DgB,YAAY,EAAE,MAAM,EAAE,KAAK,CAAC,EAAE,WAAW;IAmhDxC,QAAQ,CAAC,GAAG,EAAE,MAAM,EAAE,eAAe,EAAG,OAAO;IAgBrD,mBAAmB,CAAC,MAAM,EAAE,MAAM,KAAK,EAAE,MAAM,EAAE,MAAM,KAAK,EAAE,SAAS,EAAG,MAAM,OAAO;CA2DjG","sources":["src/src/viewer.ts","src/viewer.ts"],"sourcesContent":[null,"// Copyright 2021-2022 Icosa Gallery\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//      http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport CameraControls from 'camera-controls';\r\nimport * as THREE from 'three';\r\n\r\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\r\nimport { VRButton } from 'three/examples/jsm/webxr/VRButton.js';\r\nimport { GLTFGoogleTiltBrushMaterialExtension } from 'three-icosa';\r\nimport * as holdEvent from \"hold-event\";\r\nimport {MathUtils, Object3D} from \"three\";\r\n// import { EffectComposer } from 'three/addons';\r\n// import { RenderPass } from 'three/addons';\r\n// import { GlitchPass } from 'three/addons';\r\n// import { OutputPass } from 'three/addons';\r\n\r\nclass SketchMetadata {\r\n    public EnvironmentGuid : string;\r\n    public Environment : string;\r\n    public UseGradient : boolean;\r\n    public SkyColorA : THREE.Color;\r\n    public SkyColorB : THREE.Color;\r\n    public SkyGradientDirection : THREE.Vector3;\r\n    public FogColor : THREE.Color;\r\n    public FogDensity : number;\r\n    public PoseTranslation : THREE.Vector3;\r\n    public PoseRotation : THREE.Quaternion;\r\n    public PoseScale : number;\r\n\r\n    constructor()\r\n    constructor(userData: any)\r\n    constructor(userData?: any) {\r\n        this.EnvironmentGuid = userData['TB_EnvironmentGuid'] ?? '';\r\n        this.Environment = userData['TB_Environment'] ?? '';\r\n        this.UseGradient = userData['TB_UseGradient'] ?? false;\r\n        this.SkyColorA = this.parseTBColor(userData['TB_SkyColorA']);\r\n        this.SkyColorB = this.parseTBColor(userData['TB_SkyColorB']);\r\n        this.SkyGradientDirection = this.parseTBVector3(userData['TB_SkyGradientDirection'], new THREE.Vector3(0, 1, 0));\r\n        this.FogColor = this.parseTBColor(userData['TB_FogColor']);\r\n        this.FogDensity = userData['TB_FogDensity'] ?? 0;\r\n        this.PoseTranslation = this.parseTBVector3(userData['TB_PoseTranslation']);\r\n        this.PoseRotation = this.parseTBRotation(userData['TB_PoseRotation']);\r\n        this.PoseScale = userData['TB_PoseScale'] ?? 1;\r\n    }\r\n\r\n    private parseTBRotation(vectorString: string) {\r\n        if (!vectorString) {return new THREE.Quaternion()}\r\n        let [x, y, z] = vectorString.split(',').map(parseFloat);\r\n        return new THREE.Quaternion().setFromEuler(new THREE.Euler(x, y, z));\r\n    }\r\n\r\n    private parseTBVector3(vectorString: string, defaultValue? : THREE.Vector3) {\r\n        if (!vectorString) {return defaultValue ?? new THREE.Vector3()}\r\n        let [x, y, z] = vectorString.split(',').map(parseFloat);\r\n        return new THREE.Vector3(x, y, z);\r\n    }\r\n\r\n    private parseTBColor(colorString: string) {\r\n        if (!colorString) {return new THREE.Color(\"#000\")}\r\n        let [r, g, b] = colorString.split(',').map(parseFloat);\r\n        return new THREE.Color(r, g, b);\r\n    }\r\n}\r\n\r\nclass EnvironmentPreset {\r\n\r\n    public Guid : string;\r\n    public Name : string;\r\n    public UseGradient : boolean;\r\n    public SkyColorA : THREE.Color;\r\n    public SkyColorB : THREE.Color;\r\n    public SkyGradientDirection : THREE.Vector3;\r\n    public FogColor : THREE.Color;\r\n    public FogDensity : number;\r\n\r\n    constructor()\r\n    constructor(preset: any)\r\n    constructor(preset?: any) {\r\n        this.Guid = preset?.guid ?? \"\";\r\n        this.Name = preset?.name ?? \"No preset\";\r\n        this.UseGradient = false    ;\r\n        this.SkyColorA = preset?.skyboxColorA ?? new THREE.Color(\"#000\");\r\n        this.SkyColorB = preset?.skyboxColorB ?? new THREE.Color(\"#000\");\r\n        this.SkyGradientDirection = new THREE.Vector3(0, 1, 0);\r\n        this.FogColor = preset?.renderSettings.fogColor ?? new THREE.Color(\"#000\");\r\n        this.FogDensity = preset?.renderSettings.fogDensity ?? 0;\r\n    }\r\n}\r\n\r\nexport class Viewer {\r\n    private icosa_frame? : HTMLElement | null;\r\n    private brushPath: URL;\r\n    private texturePath: URL;\r\n    private environmentPath: URL;\r\n    private scene : THREE.Scene;\r\n\r\n    private gltfLoader: GLTFLoader;\r\n\r\n    private sceneCamera: THREE.PerspectiveCamera;\r\n    private sceneColor: THREE.Color = new THREE.Color(\"#000000\");\r\n\r\n    private cameraControls: CameraControls;\r\n\r\n    private loadedModel?: THREE.Object3D;\r\n    private sketchBoundingBox?: THREE.Box3;\r\n    private sketchMetadata?: SketchMetadata;\r\n\r\n    private setupNavigation(cameraControls : CameraControls): void {\r\n        const KEYCODE = {\r\n            W: 87,\r\n            A: 65,\r\n            S: 83,\r\n            D: 68,\r\n            Q: 81,\r\n            E: 69,\r\n            ARROW_LEFT : 37,\r\n            ARROW_UP   : 38,\r\n            ARROW_RIGHT: 39,\r\n            ARROW_DOWN : 40,\r\n        };\r\n\r\n\r\n        const wKey = new holdEvent.KeyboardKeyHold( KEYCODE.W, 1);\r\n        const aKey = new holdEvent.KeyboardKeyHold( KEYCODE.A, 1);\r\n        const sKey = new holdEvent.KeyboardKeyHold( KEYCODE.S, 1);\r\n        const dKey = new holdEvent.KeyboardKeyHold( KEYCODE.D, 1);\r\n        const qKey = new holdEvent.KeyboardKeyHold( KEYCODE.Q, 1);\r\n        const eKey = new holdEvent.KeyboardKeyHold( KEYCODE.E, 1);\r\n        aKey.addEventListener( 'holding', function( event ) { cameraControls.truck(- 0.01 * event?.deltaTime, 0, true ) } );\r\n        dKey.addEventListener( 'holding', function( event ) { cameraControls.truck(  0.01 * event?.deltaTime, 0, true ) } );\r\n        wKey.addEventListener( 'holding', function( event ) { cameraControls.forward(   0.01 * event?.deltaTime, true ) } );\r\n        sKey.addEventListener( 'holding', function( event ) { cameraControls.forward( - 0.01 * event?.deltaTime, true ) } );\r\n        qKey.addEventListener( 'holding', function( event ) { cameraControls.truck( 0,  0.01 * event?.deltaTime, true ) } );\r\n        eKey.addEventListener( 'holding', function( event ) { cameraControls.truck( 0,- 0.01 * event?.deltaTime, true ) } );\r\n        // Leaving this here because I hope I can use it later somehow.\r\n        // cameraControls.mouseButtons.wheel = CameraControls.ACTION.ZOOM;\r\n\r\n        const leftKey  = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_LEFT,  1);\r\n        const rightKey = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_RIGHT, 1);\r\n        const upKey    = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_UP,    1);\r\n        const downKey  = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_DOWN,  1);\r\n        leftKey.addEventListener ( 'holding', function( event ) { cameraControls.rotate(   0.1 * MathUtils.DEG2RAD * event?.deltaTime, 0, true ) } );\r\n        rightKey.addEventListener( 'holding', function( event ) { cameraControls.rotate( - 0.1 * MathUtils.DEG2RAD * event?.deltaTime, 0, true ) } );\r\n        upKey.addEventListener   ( 'holding', function( event ) { cameraControls.rotate( 0, - 0.05 * MathUtils.DEG2RAD * event?.deltaTime, true ) } );\r\n        downKey.addEventListener ( 'holding', function( event ) { cameraControls.rotate( 0,   0.05 * MathUtils.DEG2RAD * event?.deltaTime, true ) } );\r\n    }\r\n\r\n    constructor(assetBaseUrl: string, frame?: HTMLElement) {\r\n        this.icosa_frame = frame;\r\n\r\n        // Attempt to find viewer frame if not assigned\r\n        if(!this.icosa_frame)\r\n            this.icosa_frame = document.getElementById('icosa-viewer');\r\n        \r\n        // Create if still not assigned\r\n        if(!this.icosa_frame) {\r\n            this.icosa_frame = document.createElement('div');\r\n            this.icosa_frame.id = 'icosa-viewer';\r\n        }\r\n\r\n        const controlPanel = document.createElement('div');\r\n        controlPanel.classList.add('control-panel');\r\n\r\n        const fullscreenButton = document.createElement('button');\r\n        fullscreenButton.classList.add('panel-button', 'fullscreen-button');\r\n        fullscreenButton.onclick = () => { this.toggleFullscreen(fullscreenButton); }\r\n        \r\n        controlPanel.appendChild(fullscreenButton);\r\n\r\n        this.icosa_frame.appendChild(controlPanel);\r\n\r\n        //loadscreen\r\n        const loadscreen = document.createElement('div');\r\n        loadscreen.id = 'loadscreen';\r\n        const loadanim = document.createElement('div');\r\n        loadanim.classList.add('loadlogo');\r\n        loadscreen.appendChild(loadanim);\r\n        this.icosa_frame.appendChild(loadscreen);\r\n        loadscreen.addEventListener('transitionend', function() {\r\n            const opacity = window.getComputedStyle(loadscreen).opacity;\r\n            if (parseFloat(opacity) < 0.2) {\r\n                loadscreen.classList.add('loaded');\r\n            }\r\n        });\r\n\r\n        const canvas = document.createElement('canvas') as HTMLCanvasElement;\r\n        canvas.id = 'c';\r\n        this.icosa_frame.appendChild(canvas);\r\n        canvas.onmousedown = () => { canvas.classList.add('grabbed'); }\r\n        canvas.onmouseup = () => { canvas.classList.remove('grabbed'); }\r\n\r\n        const renderer = new THREE.WebGLRenderer({canvas : canvas});\r\n        renderer.setPixelRatio(window.devicePixelRatio);\r\n        renderer.outputColorSpace = THREE.SRGBColorSpace;\r\n\r\n        renderer.xr.enabled = true;\r\n        this.icosa_frame.appendChild( VRButton.createButton( renderer ) );\r\n        \r\n        const clock = new THREE.Clock();\r\n        \r\n        const fov = 75;\r\n        const aspect = 2;  \r\n        const near = 0.1;\r\n        const far = 1000;\r\n        const flatCamera = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n        flatCamera.position.set(10, 10, 10);\r\n\r\n        CameraControls.install({ THREE: THREE });\r\n        this.cameraControls = new CameraControls(flatCamera, canvas);\r\n        this.cameraControls.dampingFactor = 0.1;\r\n        this.cameraControls.polarRotateSpeed = this.cameraControls.azimuthRotateSpeed = 0.5;\r\n        this.cameraControls.setTarget(0, 0, 0);\r\n        this.cameraControls.dollyTo(3, true);\r\n\r\n        flatCamera.updateProjectionMatrix();\r\n\r\n        this.sceneCamera = flatCamera;\r\n\r\n        const xrCamera = new THREE.PerspectiveCamera(fov, aspect, near, far);\r\n        xrCamera.updateProjectionMatrix();\r\n\r\n        this.setupNavigation(this.cameraControls);\r\n\r\n        this.scene = new THREE.Scene();\r\n\r\n        const viewer = this;\r\n\r\n        const manager = new THREE.LoadingManager();\r\n        manager.onStart = function() {\r\n            document.getElementById('loadscreen')?.classList.remove('fade-out');\r\n            document.getElementById('loadscreen')?.classList.remove('loaded');\r\n        };\r\n\r\n        manager.onLoad = function () {\r\n            document.getElementById('loadscreen')?.classList.add('fade-out');\r\n        };\r\n\r\n        this.brushPath = new URL('brushes/', assetBaseUrl);\r\n        this.environmentPath = new URL('environments/', assetBaseUrl);\r\n        this.texturePath = new URL('textures/', assetBaseUrl);\r\n\r\n        this.gltfLoader = new GLTFLoader(manager);\r\n        this.gltfLoader.register(\r\n            parser => new GLTFGoogleTiltBrushMaterialExtension(parser, this.brushPath.toString())\r\n        );\r\n\r\n        const dracoLoader = new DRACOLoader();\r\n        dracoLoader.setDecoderPath('https://www.gstatic.com/draco/v1/decoders/');\r\n        this.gltfLoader.setDRACOLoader(dracoLoader);\r\n\r\n        function animate() {\r\n            renderer.setAnimationLoop(render);\r\n            // requestAnimationFrame( animate );\r\n            // composer.render();\r\n        }\r\n\r\n        function render() {\r\n\r\n            const delta = clock.getDelta();\r\n            \r\n            if(renderer.xr.isPresenting) {\r\n                viewer.sceneCamera = xrCamera;\r\n            } else {\r\n                viewer.sceneCamera = flatCamera;\r\n\r\n                const needResize = canvas.width !== canvas.clientWidth || canvas.height !== canvas.clientHeight;\r\n                if (needResize) {\r\n                    renderer.setSize(canvas.clientWidth, canvas.clientHeight, false);\r\n                    flatCamera.aspect = canvas.clientWidth / canvas.clientHeight;\r\n                    flatCamera.updateProjectionMatrix();\r\n                }\r\n\r\n                viewer.cameraControls.update(delta);\r\n            }\r\n\r\n            renderer.render(viewer.scene, viewer.sceneCamera);\r\n        }\r\n\r\n        animate();\r\n    }\r\n\r\n    private toggleFullscreen(controlButton: HTMLButtonElement) {\r\n        if(this.icosa_frame?.requestFullscreen)\r\n            this.icosa_frame?.requestFullscreen();\r\n\r\n        document.onfullscreenchange = ()  => {\r\n            if (document.fullscreenElement == null) {\r\n                controlButton.onclick = () => {\r\n                    if(this.icosa_frame?.requestFullscreen)\r\n                        this.icosa_frame?.requestFullscreen();\r\n                };\r\n                controlButton.classList.remove('fullscreen');\r\n            } else {\r\n                controlButton.onclick = () => {\r\n                    if(document.exitFullscreen)\r\n                        document.exitFullscreen();\r\n                };\r\n                controlButton.classList.add('fullscreen');\r\n            }\r\n        }\r\n    }\r\n\r\n    private initializeScene() {\r\n\r\n        if(!this.loadedModel)\r\n            return;\r\n\r\n        this.scene.clear();\r\n        this.initSceneBackground();\r\n        this.initSceneLights();\r\n\r\n        this.scene.add(this.loadedModel);\r\n\r\n        // Setup camera to center model\r\n        const box = this.sketchBoundingBox;\r\n        if (box != undefined && box != null) {\r\n            const boxSize = box.getSize(new THREE.Vector3()).length();\r\n            const boxCenter = box.getCenter(new THREE.Vector3());\r\n\r\n            this.cameraControls.minDistance = boxSize * 0.01;\r\n            this.cameraControls.maxDistance = boxSize * 10;\r\n\r\n            const midDistance = this.cameraControls.minDistance + (boxSize - this.cameraControls.minDistance) / 2;\r\n            this.cameraControls.setTarget(boxCenter.x, boxCenter.y, boxCenter.z);\r\n            this.cameraControls.dollyTo(midDistance, true);\r\n            this.cameraControls.saveState();\r\n        }\r\n\r\n        const ambientLight = new THREE.AmbientLight();\r\n        this.scene.add(ambientLight);\r\n    }\r\n\r\n    private static lookupEnvironment(guid : string) {\r\n        return {\r\n            \"e38af599-4575-46ff-a040-459703dbcd36\": {\r\n                name: \"Passthrough\",\r\n                guid: \"e38af599-4575-46ff-a040-459703dbcd36\",\r\n                renderSettings: {\r\n                    fogEnabled: false,\r\n                    fogColor: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 0.0\r\n                    },\r\n                    fogDensity: 0.0,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 1.0,\r\n                        g: 1.0,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.5,\r\n                        g: 0.5,\r\n                        b: 0.5,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 0.0,\r\n                    skyboxTint: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 0.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/Passthrough\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.3\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 1.16949809,\r\n                            g: 1.19485855,\r\n                            b: 1.31320751,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 60.0000038,\r\n                            y: 0.0,\r\n                            z: 25.9999962\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.428235322,\r\n                            g: 0.4211765,\r\n                            b: 0.3458824,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 180.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: 0.0,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.0,\r\n                    g: 0.0,\r\n                    b: 0.0,\r\n                    a: 0.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.0,\r\n                    g: 0.0,\r\n                    b: 0.0,\r\n                    a: 0.0\r\n                }\r\n            },\r\n            \"ab080599-e465-4a6d-8587-43bf495af68b\": {\r\n                name: \"Standard\",\r\n                guid: \"ab080599-e465-4a6d-8587-43bf495af68b\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.164705887,\r\n                        g: 0.164705887,\r\n                        b: 0.20784314,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.0025,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.156862751,\r\n                        g: 0.156862751,\r\n                        b: 0.203921571,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.392156869,\r\n                        g: 0.392156869,\r\n                        b: 0.392156869,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 0.9,\r\n                    skyboxTint: {\r\n                        r: 0.235294119,\r\n                        g: 0.2509804,\r\n                        b: 0.3529412,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/Standard\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_CarpetedHallway\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.3\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.7780392,\r\n                            g: 0.815686345,\r\n                            b: 0.9913726,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 60.0000038,\r\n                            y: 0.0,\r\n                            z: 25.9999962\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.428235322,\r\n                            g: 0.4211765,\r\n                            b: 0.3458824,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 180.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: 0.0,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.274509817,\r\n                    g: 0.274509817,\r\n                    b: 0.31764707,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.03529412,\r\n                    g: 0.03529412,\r\n                    b: 0.08627451,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"c504347a-c96d-4505-853b-87b484acff9a\": {\r\n                name: \"NightSky\",\r\n                guid: \"c504347a-c96d-4505-853b-87b484acff9a\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.0196078438,\r\n                        g: 0.0117647061,\r\n                        b: 0.0431372561,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.006,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.3019608,\r\n                        g: 0.3019608,\r\n                        b: 0.6039216,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.0,\r\n                    skyboxTint: {\r\n                        r: 1.0,\r\n                        g: 1.0,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/NightSky\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Mountains\",\r\n                    skyboxCubemap: \"nightsky\",\r\n                    reflectionCubemap: \"milkyway_reflection\",\r\n                    reflectionIntensity: 3.0\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 1.02352941,\r\n                            g: 0.7647059,\r\n                            b: 0.929411769,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 65.0,\r\n                            y: 0.0,\r\n                            z: 25.9999981\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.0,\r\n                            g: 0.0,\r\n                            b: 0.0,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: 0.0,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.08235294,\r\n                    g: 0.0470588244,\r\n                    b: 0.184313729,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.0,\r\n                    g: 0.0,\r\n                    b: 0.0,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"96cf6f36-47b6-44f4-bdbf-63be2ddac909\": {\r\n                name: \"Space\",\r\n                guid: \"96cf6f36-47b6-44f4-bdbf-63be2ddac909\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.0,\r\n                    fogStartDistance: 5.0,\r\n                    fogEndDistance: 20.0,\r\n                    clearColor: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.227450982,\r\n                        g: 0.20784314,\r\n                        b: 0.360784322,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.0,\r\n                    skyboxTint: {\r\n                        r: 1.0,\r\n                        g: 1.0,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/Space\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Arena\",\r\n                    skyboxCubemap: \"milkyway_PNG\",\r\n                    reflectionCubemap: \"milkyway_reflection\",\r\n                    reflectionIntensity: 3.0\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 1.16000009,\r\n                            g: 0.866666734,\r\n                            b: 0.866666734,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 30.0000019,\r\n                            y: 39.9999962,\r\n                            z: 50.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.0,\r\n                            g: 0.0,\r\n                            b: 0.0,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 20.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.0,\r\n                    g: 0.0,\r\n                    b: 0.0,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.121568628,\r\n                    g: 0.03529412,\r\n                    b: 0.172549024,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"e2e72b76-d443-4721-97e6-f3d49fe98dda\": {\r\n                name: \"DressForm\",\r\n                guid: \"e2e72b76-d443-4721-97e6-f3d49fe98dda\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.172549024,\r\n                        g: 0.180392161,\r\n                        b: 0.243137255,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.007,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.219607845,\r\n                        g: 0.227450982,\r\n                        b: 0.31764707,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.4117647,\r\n                        g: 0.3529412,\r\n                        b: 0.596078455,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 0.61,\r\n                    skyboxTint: {\r\n                        r: 0.458823532,\r\n                        g: 0.5137255,\r\n                        b: 0.7882353,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/DressForm\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_LivingRoom\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.3\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 1.1152941,\r\n                            g: 0.917647064,\r\n                            b: 0.7764706,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 7.0\r\n                        },\r\n                        rotation: {\r\n                            x: 50.0,\r\n                            y: 41.9999962,\r\n                            z: 25.9999924\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.356862754,\r\n                            g: 0.3509804,\r\n                            b: 0.2882353,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 227.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: 0.0,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.34117648,\r\n                    g: 0.345098048,\r\n                    b: 0.4509804,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.09411765,\r\n                    g: 0.105882354,\r\n                    b: 0.1764706,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"ab080511-e465-4a6d-8587-53bf495af68b\": {\r\n                name: \"Pedestal\",\r\n                guid: \"ab080511-e465-4a6d-8587-53bf495af68b\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.172549024,\r\n                        g: 0.180392161,\r\n                        b: 0.243137255,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.007,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.219607845,\r\n                        g: 0.227450982,\r\n                        b: 0.31764707,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.4117647,\r\n                        g: 0.3529412,\r\n                        b: 0.596078455,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 0.61,\r\n                    skyboxTint: {\r\n                        r: 0.458823532,\r\n                        g: 0.5137255,\r\n                        b: 0.7882353,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/Pedestal\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_LivingRoom\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 1.0\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 1.1152941,\r\n                            g: 0.917647064,\r\n                            b: 0.7764706,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 7.0\r\n                        },\r\n                        rotation: {\r\n                            x: 50.0,\r\n                            y: 41.9999962,\r\n                            z: 25.9999924\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.356862754,\r\n                            g: 0.3509804,\r\n                            b: 0.2882353,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 227.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: 0.0,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 9.675,\r\n                    z: 5.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.34117648,\r\n                    g: 0.345098048,\r\n                    b: 0.4509804,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.09411765,\r\n                    g: 0.105882354,\r\n                    b: 0.1764706,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"ab080511-e565-4a6d-8587-53bf495af68b\": {\r\n                name: \"Snowman\",\r\n                guid: \"ab080511-e565-4a6d-8587-53bf495af68b\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.6509804,\r\n                        g: 0.7254902,\r\n                        b: 0.8745098,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.005,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.6509804,\r\n                        g: 0.7019608,\r\n                        b: 0.870588243,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.7294118,\r\n                        g: 0.7294118,\r\n                        b: 0.7294118,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 0.95,\r\n                    skyboxTint: {\r\n                        r: 0.75686276,\r\n                        g: 0.819607854,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/Snowman\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_PaddedCell\",\r\n                    skyboxCubemap: \"snowysky\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.3\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.241451,\r\n                            g: 0.234078437,\r\n                            b: 0.3465098,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 58.0,\r\n                            y: 315.999969,\r\n                            z: 50.0000038\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.410980433,\r\n                            g: 0.4956863,\r\n                            b: 0.65882355,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 8.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0,\r\n                            y: 143.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: 0.0,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.4627451,\r\n                    g: 0.5647059,\r\n                    b: 0.7058824,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.7607843,\r\n                    g: 0.8156863,\r\n                    b: 0.972549,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"36e65e4f-17d7-41ef-834a-e525db0b9888\": {\r\n                name: \"PinkLemonade\",\r\n                guid: \"36e65e4f-17d7-41ef-834a-e525db0b9888\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 1.0,\r\n                        g: 0.5514706,\r\n                        b: 0.9319472,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.025,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.827451,\r\n                        g: 0.368627459,\r\n                        b: 0.34117648,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 1.0,\r\n                        g: 0.9019608,\r\n                        b: 0.854901969,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.0,\r\n                    skyboxTint: {\r\n                        r: 0.827451,\r\n                        g: 0.368627459,\r\n                        b: 0.34117648,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDustDim\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"gradientblue\",\r\n                    reflectionIntensity: 0.0\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.0,\r\n                            g: 0.0,\r\n                            b: 0.0,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 318.189667,\r\n                            y: 116.565048,\r\n                            z: 116.565048\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 0.0,\r\n                        spotAngle: 0.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.5,\r\n                            g: 0.28039217,\r\n                            b: 0.3156863,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 0.0,\r\n                        spotAngle: 0.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 80.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 1.0,\r\n                    g: 0.882352948,\r\n                    b: 0.65882355,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.858823538,\r\n                    g: 0.294117659,\r\n                    b: 0.3647059,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"a9bc2bc8-6d86-4cda-82a9-283e0f3977ac\": {\r\n                name: \"Pistachio\",\r\n                guid: \"a9bc2bc8-6d86-4cda-82a9-283e0f3977ac\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.2784314,\r\n                        g: 0.5686275,\r\n                        b: 0.458823532,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.015,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.9558824,\r\n                        g: 0.6708847,\r\n                        b: 0.513083935,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.610186,\r\n                        g: 0.838235259,\r\n                        b: 0.75194633,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.0,\r\n                    skyboxTint: {\r\n                        r: 0.797,\r\n                        g: 0.616,\r\n                        b: 0.755,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDustDim\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"gradientblue\",\r\n                    reflectionIntensity: 0.3\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.209818333,\r\n                            g: 0.242647052,\r\n                            b: 0.171280265,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 41.810318,\r\n                            y: 116.565048,\r\n                            z: 243.434937\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 0.0,\r\n                        spotAngle: 0.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.977941155,\r\n                            g: 0.506417,\r\n                            b: 0.438635379,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 0.0,\r\n                        spotAngle: 0.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 50.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 1.0,\r\n                    g: 0.5176471,\r\n                    b: 0.3529412,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.458823532,\r\n                    g: 0.78039217,\r\n                    b: 0.5529412,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"e65cde1a-a177-4bfb-b93f-f673c99a32bc\": {\r\n                name: \"Illustrative\",\r\n                guid: \"e65cde1a-a177-4bfb-b93f-f673c99a32bc\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 1.0,\r\n                        g: 1.0,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.0125,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.7019608,\r\n                        g: 0.7019608,\r\n                        b: 0.7019608,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 1.0,\r\n                        g: 1.0,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 0.0,\r\n                    skyboxTint: {\r\n                        r: 0.625,\r\n                        g: 0.625,\r\n                        b: 0.625,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDustDim\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"\",\r\n                    reflectionIntensity: 0.0\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.0,\r\n                            g: 0.0,\r\n                            b: 0.0,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 0.0,\r\n                            y: 180.0,\r\n                            z: 180.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 0.0,\r\n                        spotAngle: 0.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.0,\r\n                            g: 0.0,\r\n                            b: 0.0,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 0.0,\r\n                        spotAngle: 0.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 100.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.7647059,\r\n                    g: 0.7647059,\r\n                    b: 0.7647059,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.623529434,\r\n                    g: 0.623529434,\r\n                    b: 0.623529434,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"580b4529-ac50-4fe9-b8d2-635765a14893\": {\r\n                name: \"Black\",\r\n                guid: \"580b4529-ac50-4fe9-b8d2-635765a14893\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.0196078438,\r\n                        g: 0.0196078438,\r\n                        b: 0.0196078438,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.0,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.392156869,\r\n                        g: 0.392156869,\r\n                        b: 0.392156869,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.0,\r\n                    skyboxTint: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDust\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.3\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.7780392,\r\n                            g: 0.815686345,\r\n                            b: 0.9913726,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 60.0000038,\r\n                            y: 0.0,\r\n                            z: 25.9999962\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.428235322,\r\n                            g: 0.4211765,\r\n                            b: 0.3458824,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 180.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 100.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.0,\r\n                    g: 0.0,\r\n                    b: 0.0,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.0,\r\n                    g: 0.0,\r\n                    b: 0.0,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"9b89b0a4-c41e-4b78-82a1-22f10a238357\": {\r\n                name: \"White\",\r\n                guid: \"9b89b0a4-c41e-4b78-82a1-22f10a238357\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 1.0,\r\n                        g: 1.0,\r\n                        b: 1.0,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.0,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.784313738,\r\n                        g: 0.784313738,\r\n                        b: 0.784313738,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.392156869,\r\n                        g: 0.392156869,\r\n                        b: 0.392156869,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.0,\r\n                    skyboxTint: {\r\n                        r: 0.0,\r\n                        g: 0.0,\r\n                        b: 0.0,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientGrid\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.4\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 0.7780392,\r\n                            g: 0.815686345,\r\n                            b: 0.9913726,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 60.0000038,\r\n                            y: 0.0,\r\n                            z: 25.9999962\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.428235322,\r\n                            g: 0.4211765,\r\n                            b: 0.3458824,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 180.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 100.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.784313738,\r\n                    g: 0.784313738,\r\n                    b: 0.784313738,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.784313738,\r\n                    g: 0.784313738,\r\n                    b: 0.784313738,\r\n                    a: 1.0\r\n                }\r\n            },\r\n            \"0ca88298-e5e8-4e94-aad8-4b4f6c80ae52\": {\r\n                name: \"Blue\",\r\n                guid: \"0ca88298-e5e8-4e94-aad8-4b4f6c80ae52\",\r\n                renderSettings: {\r\n                    fogEnabled: true,\r\n                    fogColor: {\r\n                        r: 0.6313726,\r\n                        g: 0.7137255,\r\n                        b: 0.894117653,\r\n                        a: 1.0\r\n                    },\r\n                    fogDensity: 0.005,\r\n                    fogStartDistance: 0.0,\r\n                    fogEndDistance: 0.0,\r\n                    clearColor: {\r\n                        r: 0.270588249,\r\n                        g: 0.309803933,\r\n                        b: 0.470588237,\r\n                        a: 1.0\r\n                    },\r\n                    ambientColor: {\r\n                        r: 0.203921571,\r\n                        g: 0.294117659,\r\n                        b: 0.368627459,\r\n                        a: 1.0\r\n                    },\r\n                    skyboxExposure: 1.46,\r\n                    skyboxTint: {\r\n                        r: 0.4627451,\r\n                        g: 0.5294118,\r\n                        b: 0.698039234,\r\n                        a: 1.0\r\n                    },\r\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientGrid_Blue\",\r\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\r\n                    skyboxCubemap: \"gradientblue\",\r\n                    reflectionCubemap: \"threelight_reflection\",\r\n                    reflectionIntensity: 0.8\r\n                },\r\n                lights: [\r\n                    {\r\n                        color: {\r\n                            r: 1.5533334,\r\n                            g: 1.40666676,\r\n                            b: 1.77333343,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 60.0000038,\r\n                            y: 0.0,\r\n                            z: 25.9999962\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: true\r\n                    },\r\n                    {\r\n                        color: {\r\n                            r: 0.271215677,\r\n                            g: 0.2667451,\r\n                            b: 0.219058827,\r\n                            a: 1.0\r\n                        },\r\n                        position: {\r\n                            x: 0.0,\r\n                            y: 0.0,\r\n                            z: 0.0\r\n                        },\r\n                        rotation: {\r\n                            x: 40.0000038,\r\n                            y: 180.0,\r\n                            z: 220.0\r\n                        },\r\n                        type: \"Directional\",\r\n                        range: 5.0,\r\n                        spotAngle: 30.0,\r\n                        shadowsEnabled: false\r\n                    }\r\n                ],\r\n                teleportBoundsHalfWidth: 100.0,\r\n                controllerXRayHeight: -1E+09,\r\n                widgetHome: {\r\n                    x: 0.0,\r\n                    y: 0.0,\r\n                    z: 0.0\r\n                },\r\n                skyboxColorA: {\r\n                    r: 0.180392161,\r\n                    g: 0.235294119,\r\n                    b: 0.4117647,\r\n                    a: 1.0\r\n                },\r\n                skyboxColorB: {\r\n                    r: 0.356862754,\r\n                    g: 0.392156869,\r\n                    b: 0.6,\r\n                    a: 1.0\r\n                }\r\n            }\r\n        }[guid];\r\n    }\r\n\r\n    public async loadGltf(url: string, loadEnvironment : boolean) {\r\n        const sceneGltf = await this.gltfLoader.loadAsync(url);\r\n        this.setupSketchMetaData(sceneGltf.scene);\r\n\r\n        if (loadEnvironment) {\r\n            const guid = this.sketchMetadata?.EnvironmentGuid;\r\n            if (guid) {\r\n                const envUrl = new URL(`${guid}/${guid}.glb`, this.environmentPath);\r\n                const envGltf = await this.gltfLoader.loadAsync(envUrl.toString());\r\n                sceneGltf.scene.add(envGltf.scene);\r\n            }\r\n        }\r\n        this.loadedModel = sceneGltf.scene;\r\n        this.initializeScene();\r\n    }\r\n\r\n    public generateGradientSky(colorA: THREE.Color, colorB: THREE.Color, direction : THREE.Vector3)\r\n    {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = 2;\r\n        canvas.height = 512;\r\n        const context = canvas.getContext('2d');\r\n        if (context == null) return null;\r\n\r\n        const gradient = context.createLinearGradient(0, 0, 0, 512);\r\n        gradient.addColorStop(0, colorA.getStyle());\r\n        gradient.addColorStop(1, colorB.getStyle());\r\n        context.fillStyle = gradient;\r\n        context.fillRect(0, 0, 2, 512);\r\n\r\n        const texture = new THREE.CanvasTexture(canvas);\r\n        texture.wrapS = THREE.RepeatWrapping;\r\n        texture.wrapT = THREE.ClampToEdgeWrapping;\r\n        const material = new THREE.MeshBasicMaterial({ map: texture, side: THREE.BackSide });\r\n\r\n        const geometry = new THREE.SphereGeometry(500, 64, 64);\r\n        const skybox = new THREE.Mesh(geometry, material);\r\n        const defaultUp = new THREE.Vector3(0, 1, 0);\r\n        const quaternion = new THREE.Quaternion().setFromUnitVectors(defaultUp, direction);\r\n        skybox.applyQuaternion(quaternion);\r\n        return skybox;\r\n    }\r\n\r\n    private setupSketchMetaData(model: Object3D<THREE.Object3DEventMap>) {\r\n        let sketchMetaData = new SketchMetadata(model.userData);\r\n        let envPreset = new EnvironmentPreset(Viewer.lookupEnvironment(sketchMetaData.EnvironmentGuid));\r\n        this.sketchBoundingBox = new THREE.Box3().setFromObject(model);\r\n        this.sketchMetadata = sketchMetaData;\r\n    }\r\n\r\n    private initSceneLights() {\r\n        if (this.sketchMetadata == undefined || this.sketchMetadata == null) {return}\r\n        var lights = new THREE.Group();\r\n    //     lights.add(new THREE.DirectionalLight(this.sketchMetadata., 1.0));\r\n        this.loadedModel?.add(lights);\r\n    }\r\n\r\n    private initSceneBackground() {\r\n        if (this.sketchMetadata == undefined || this.sketchMetadata == null) {return}\r\n        if (this.sketchMetadata.UseGradient) {\r\n            var sky = this.generateGradientSky(\r\n                this.sketchMetadata.SkyColorA,\r\n                this.sketchMetadata.SkyColorB,\r\n                this.sketchMetadata.SkyGradientDirection\r\n            );\r\n            if (sky !== null) {\r\n                this.loadedModel?.add(sky as Object3D<THREE.Object3DEventMap>);\r\n            }\r\n        }\r\n        else {\r\n            this.scene.background = this.sceneColor;\r\n        }\r\n    }\r\n\r\n\r\n}"],"names":[],"version":3,"file":"icosa-viewer.d.ts.map"}