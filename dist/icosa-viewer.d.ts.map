{"mappings":";AAqGA;gBA0DgB,YAAY,EAAE,MAAM,EAAE,KAAK,CAAC,EAAE,WAAW;IAmhDxC,QAAQ,CAAC,GAAG,EAAE,MAAM,EAAE,eAAe,EAAG,OAAO;IAgBrD,mBAAmB,CAAC,MAAM,EAAE,MAAM,KAAK,EAAE,MAAM,EAAE,MAAM,KAAK,EAAE,SAAS,EAAG,MAAM,OAAO;CA2DjG","sources":["src/src/viewer.ts","src/viewer.ts"],"sourcesContent":[null,"// Copyright 2021-2022 Icosa Gallery\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport CameraControls from 'camera-controls';\nimport * as THREE from 'three';\n\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { VRButton } from 'three/examples/jsm/webxr/VRButton.js';\nimport { GLTFGoogleTiltBrushMaterialExtension } from 'three-icosa';\nimport * as holdEvent from \"hold-event\";\nimport {MathUtils, Object3D} from \"three\";\n// import { EffectComposer } from 'three/addons';\n// import { RenderPass } from 'three/addons';\n// import { GlitchPass } from 'three/addons';\n// import { OutputPass } from 'three/addons';\n\nclass SketchMetadata {\n    public EnvironmentGuid : string;\n    public Environment : string;\n    public UseGradient : boolean;\n    public SkyColorA : THREE.Color;\n    public SkyColorB : THREE.Color;\n    public SkyGradientDirection : THREE.Vector3;\n    public FogColor : THREE.Color;\n    public FogDensity : number;\n    public PoseTranslation : THREE.Vector3;\n    public PoseRotation : THREE.Quaternion;\n    public PoseScale : number;\n\n    constructor()\n    constructor(userData: any)\n    constructor(userData?: any) {\n        this.EnvironmentGuid = userData['TB_EnvironmentGuid'] ?? '';\n        this.Environment = userData['TB_Environment'] ?? '';\n        this.UseGradient = userData['TB_UseGradient'] ?? false;\n        this.SkyColorA = this.parseTBColor(userData['TB_SkyColorA']);\n        this.SkyColorB = this.parseTBColor(userData['TB_SkyColorB']);\n        this.SkyGradientDirection = this.parseTBVector3(userData['TB_SkyGradientDirection'], new THREE.Vector3(0, 1, 0));\n        this.FogColor = this.parseTBColor(userData['TB_FogColor']);\n        this.FogDensity = userData['TB_FogDensity'] ?? 0;\n        this.PoseTranslation = this.parseTBVector3(userData['TB_PoseTranslation']);\n        this.PoseRotation = this.parseTBRotation(userData['TB_PoseRotation']);\n        this.PoseScale = userData['TB_PoseScale'] ?? 1;\n    }\n\n    private parseTBRotation(vectorString: string) {\n        if (!vectorString) {return new THREE.Quaternion()}\n        let [x, y, z] = vectorString.split(',').map(parseFloat);\n        return new THREE.Quaternion().setFromEuler(new THREE.Euler(x, y, z));\n    }\n\n    private parseTBVector3(vectorString: string, defaultValue? : THREE.Vector3) {\n        if (!vectorString) {return defaultValue ?? new THREE.Vector3()}\n        let [x, y, z] = vectorString.split(',').map(parseFloat);\n        return new THREE.Vector3(x, y, z);\n    }\n\n    private parseTBColor(colorString: string) {\n        if (!colorString) {return new THREE.Color(\"#000\")}\n        let [r, g, b] = colorString.split(',').map(parseFloat);\n        return new THREE.Color(r, g, b);\n    }\n}\n\nclass EnvironmentPreset {\n\n    public Guid : string;\n    public Name : string;\n    public UseGradient : boolean;\n    public SkyColorA : THREE.Color;\n    public SkyColorB : THREE.Color;\n    public SkyGradientDirection : THREE.Vector3;\n    public FogColor : THREE.Color;\n    public FogDensity : number;\n\n    constructor()\n    constructor(preset: any)\n    constructor(preset?: any) {\n        this.Guid = preset?.guid ?? \"\";\n        this.Name = preset?.name ?? \"No preset\";\n        this.UseGradient = false    ;\n        this.SkyColorA = preset?.skyboxColorA ?? new THREE.Color(\"#000\");\n        this.SkyColorB = preset?.skyboxColorB ?? new THREE.Color(\"#000\");\n        this.SkyGradientDirection = new THREE.Vector3(0, 1, 0);\n        this.FogColor = preset?.renderSettings.fogColor ?? new THREE.Color(\"#000\");\n        this.FogDensity = preset?.renderSettings.fogDensity ?? 0;\n    }\n}\n\nexport class Viewer {\n    private icosa_frame? : HTMLElement | null;\n    private brushPath: URL;\n    private texturePath: URL;\n    private environmentPath: URL;\n    private scene : THREE.Scene;\n\n    private gltfLoader: GLTFLoader;\n\n    private sceneCamera: THREE.PerspectiveCamera;\n    private sceneColor: THREE.Color = new THREE.Color(\"#000000\");\n\n    private cameraControls: CameraControls;\n\n    private loadedModel?: THREE.Object3D;\n    private sketchBoundingBox?: THREE.Box3;\n    private sketchMetadata?: SketchMetadata;\n\n    private setupNavigation(cameraControls : CameraControls): void {\n        const KEYCODE = {\n            W: 87,\n            A: 65,\n            S: 83,\n            D: 68,\n            Q: 81,\n            E: 69,\n            ARROW_LEFT : 37,\n            ARROW_UP   : 38,\n            ARROW_RIGHT: 39,\n            ARROW_DOWN : 40,\n        };\n\n\n        const wKey = new holdEvent.KeyboardKeyHold( KEYCODE.W, 1);\n        const aKey = new holdEvent.KeyboardKeyHold( KEYCODE.A, 1);\n        const sKey = new holdEvent.KeyboardKeyHold( KEYCODE.S, 1);\n        const dKey = new holdEvent.KeyboardKeyHold( KEYCODE.D, 1);\n        const qKey = new holdEvent.KeyboardKeyHold( KEYCODE.Q, 1);\n        const eKey = new holdEvent.KeyboardKeyHold( KEYCODE.E, 1);\n        aKey.addEventListener( 'holding', function( event ) { cameraControls.truck(- 0.01 * event?.deltaTime, 0, true ) } );\n        dKey.addEventListener( 'holding', function( event ) { cameraControls.truck(  0.01 * event?.deltaTime, 0, true ) } );\n        wKey.addEventListener( 'holding', function( event ) { cameraControls.forward(   0.01 * event?.deltaTime, true ) } );\n        sKey.addEventListener( 'holding', function( event ) { cameraControls.forward( - 0.01 * event?.deltaTime, true ) } );\n        qKey.addEventListener( 'holding', function( event ) { cameraControls.truck( 0,  0.01 * event?.deltaTime, true ) } );\n        eKey.addEventListener( 'holding', function( event ) { cameraControls.truck( 0,- 0.01 * event?.deltaTime, true ) } );\n        // Leaving this here because I hope I can use it later somehow.\n        // cameraControls.mouseButtons.wheel = CameraControls.ACTION.ZOOM;\n\n        const leftKey  = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_LEFT,  1);\n        const rightKey = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_RIGHT, 1);\n        const upKey    = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_UP,    1);\n        const downKey  = new holdEvent.KeyboardKeyHold( KEYCODE.ARROW_DOWN,  1);\n        leftKey.addEventListener ( 'holding', function( event ) { cameraControls.rotate(   0.1 * MathUtils.DEG2RAD * event?.deltaTime, 0, true ) } );\n        rightKey.addEventListener( 'holding', function( event ) { cameraControls.rotate( - 0.1 * MathUtils.DEG2RAD * event?.deltaTime, 0, true ) } );\n        upKey.addEventListener   ( 'holding', function( event ) { cameraControls.rotate( 0, - 0.05 * MathUtils.DEG2RAD * event?.deltaTime, true ) } );\n        downKey.addEventListener ( 'holding', function( event ) { cameraControls.rotate( 0,   0.05 * MathUtils.DEG2RAD * event?.deltaTime, true ) } );\n    }\n\n    constructor(assetBaseUrl: string, frame?: HTMLElement) {\n        this.icosa_frame = frame;\n\n        // Attempt to find viewer frame if not assigned\n        if(!this.icosa_frame)\n            this.icosa_frame = document.getElementById('icosa-viewer');\n        \n        // Create if still not assigned\n        if(!this.icosa_frame) {\n            this.icosa_frame = document.createElement('div');\n            this.icosa_frame.id = 'icosa-viewer';\n        }\n\n        const controlPanel = document.createElement('div');\n        controlPanel.classList.add('control-panel');\n\n        const fullscreenButton = document.createElement('button');\n        fullscreenButton.classList.add('panel-button', 'fullscreen-button');\n        fullscreenButton.onclick = () => { this.toggleFullscreen(fullscreenButton); }\n        \n        controlPanel.appendChild(fullscreenButton);\n\n        this.icosa_frame.appendChild(controlPanel);\n\n        //loadscreen\n        const loadscreen = document.createElement('div');\n        loadscreen.id = 'loadscreen';\n        const loadanim = document.createElement('div');\n        loadanim.classList.add('loadlogo');\n        loadscreen.appendChild(loadanim);\n        this.icosa_frame.appendChild(loadscreen);\n        loadscreen.addEventListener('transitionend', function() {\n            const opacity = window.getComputedStyle(loadscreen).opacity;\n            if (parseFloat(opacity) < 0.2) {\n                loadscreen.classList.add('loaded');\n            }\n        });\n\n        const canvas = document.createElement('canvas') as HTMLCanvasElement;\n        canvas.id = 'c';\n        this.icosa_frame.appendChild(canvas);\n        canvas.onmousedown = () => { canvas.classList.add('grabbed'); }\n        canvas.onmouseup = () => { canvas.classList.remove('grabbed'); }\n\n        const renderer = new THREE.WebGLRenderer({canvas : canvas});\n        renderer.setPixelRatio(window.devicePixelRatio);\n        renderer.outputColorSpace = THREE.SRGBColorSpace;\n\n        renderer.xr.enabled = true;\n        this.icosa_frame.appendChild( VRButton.createButton( renderer ) );\n        \n        const clock = new THREE.Clock();\n        \n        const fov = 75;\n        const aspect = 2;  \n        const near = 0.1;\n        const far = 1000;\n        const flatCamera = new THREE.PerspectiveCamera(fov, aspect, near, far);\n        flatCamera.position.set(10, 10, 10);\n\n        CameraControls.install({ THREE: THREE });\n        this.cameraControls = new CameraControls(flatCamera, canvas);\n        this.cameraControls.dampingFactor = 0.1;\n        this.cameraControls.polarRotateSpeed = this.cameraControls.azimuthRotateSpeed = 0.5;\n        this.cameraControls.setTarget(0, 0, 0);\n        this.cameraControls.dollyTo(3, true);\n\n        flatCamera.updateProjectionMatrix();\n\n        this.sceneCamera = flatCamera;\n\n        const xrCamera = new THREE.PerspectiveCamera(fov, aspect, near, far);\n        xrCamera.updateProjectionMatrix();\n\n        this.setupNavigation(this.cameraControls);\n\n        this.scene = new THREE.Scene();\n\n        const viewer = this;\n\n        const manager = new THREE.LoadingManager();\n        manager.onStart = function() {\n            document.getElementById('loadscreen')?.classList.remove('fade-out');\n            document.getElementById('loadscreen')?.classList.remove('loaded');\n        };\n\n        manager.onLoad = function () {\n            document.getElementById('loadscreen')?.classList.add('fade-out');\n        };\n\n        this.brushPath = new URL('brushes/', assetBaseUrl);\n        this.environmentPath = new URL('environments/', assetBaseUrl);\n        this.texturePath = new URL('textures/', assetBaseUrl);\n\n        this.gltfLoader = new GLTFLoader(manager);\n        this.gltfLoader.register(\n            parser => new GLTFGoogleTiltBrushMaterialExtension(parser, this.brushPath.toString())\n        );\n\n        const dracoLoader = new DRACOLoader();\n        dracoLoader.setDecoderPath('https://www.gstatic.com/draco/v1/decoders/');\n        this.gltfLoader.setDRACOLoader(dracoLoader);\n\n        function animate() {\n            renderer.setAnimationLoop(render);\n            // requestAnimationFrame( animate );\n            // composer.render();\n        }\n\n        function render() {\n\n            const delta = clock.getDelta();\n            \n            if(renderer.xr.isPresenting) {\n                viewer.sceneCamera = xrCamera;\n            } else {\n                viewer.sceneCamera = flatCamera;\n\n                const needResize = canvas.width !== canvas.clientWidth || canvas.height !== canvas.clientHeight;\n                if (needResize) {\n                    renderer.setSize(canvas.clientWidth, canvas.clientHeight, false);\n                    flatCamera.aspect = canvas.clientWidth / canvas.clientHeight;\n                    flatCamera.updateProjectionMatrix();\n                }\n\n                viewer.cameraControls.update(delta);\n            }\n\n            renderer.render(viewer.scene, viewer.sceneCamera);\n        }\n\n        animate();\n    }\n\n    private toggleFullscreen(controlButton: HTMLButtonElement) {\n        if(this.icosa_frame?.requestFullscreen)\n            this.icosa_frame?.requestFullscreen();\n\n        document.onfullscreenchange = ()  => {\n            if (document.fullscreenElement == null) {\n                controlButton.onclick = () => {\n                    if(this.icosa_frame?.requestFullscreen)\n                        this.icosa_frame?.requestFullscreen();\n                };\n                controlButton.classList.remove('fullscreen');\n            } else {\n                controlButton.onclick = () => {\n                    if(document.exitFullscreen)\n                        document.exitFullscreen();\n                };\n                controlButton.classList.add('fullscreen');\n            }\n        }\n    }\n\n    private initializeScene() {\n\n        if(!this.loadedModel)\n            return;\n\n        this.scene.clear();\n        this.initSceneBackground();\n        this.initSceneLights();\n\n        this.scene.add(this.loadedModel);\n\n        // Setup camera to center model\n        const box = this.sketchBoundingBox;\n        if (box != undefined && box != null) {\n            const boxSize = box.getSize(new THREE.Vector3()).length();\n            const boxCenter = box.getCenter(new THREE.Vector3());\n\n            this.cameraControls.minDistance = boxSize * 0.01;\n            this.cameraControls.maxDistance = boxSize * 10;\n\n            const midDistance = this.cameraControls.minDistance + (boxSize - this.cameraControls.minDistance) / 2;\n            this.cameraControls.setTarget(boxCenter.x, boxCenter.y, boxCenter.z);\n            this.cameraControls.dollyTo(midDistance, true);\n            this.cameraControls.saveState();\n        }\n\n        const ambientLight = new THREE.AmbientLight();\n        this.scene.add(ambientLight);\n    }\n\n    private static lookupEnvironment(guid : string) {\n        return {\n            \"e38af599-4575-46ff-a040-459703dbcd36\": {\n                name: \"Passthrough\",\n                guid: \"e38af599-4575-46ff-a040-459703dbcd36\",\n                renderSettings: {\n                    fogEnabled: false,\n                    fogColor: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 0.0\n                    },\n                    fogDensity: 0.0,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 1.0,\n                        g: 1.0,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.5,\n                        g: 0.5,\n                        b: 0.5,\n                        a: 1.0\n                    },\n                    skyboxExposure: 0.0,\n                    skyboxTint: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 0.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/Passthrough\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.3\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 1.16949809,\n                            g: 1.19485855,\n                            b: 1.31320751,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 60.0000038,\n                            y: 0.0,\n                            z: 25.9999962\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.428235322,\n                            g: 0.4211765,\n                            b: 0.3458824,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 180.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: 0.0,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.0,\n                    g: 0.0,\n                    b: 0.0,\n                    a: 0.0\n                },\n                skyboxColorB: {\n                    r: 0.0,\n                    g: 0.0,\n                    b: 0.0,\n                    a: 0.0\n                }\n            },\n            \"ab080599-e465-4a6d-8587-43bf495af68b\": {\n                name: \"Standard\",\n                guid: \"ab080599-e465-4a6d-8587-43bf495af68b\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.164705887,\n                        g: 0.164705887,\n                        b: 0.20784314,\n                        a: 1.0\n                    },\n                    fogDensity: 0.0025,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.156862751,\n                        g: 0.156862751,\n                        b: 0.203921571,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.392156869,\n                        g: 0.392156869,\n                        b: 0.392156869,\n                        a: 1.0\n                    },\n                    skyboxExposure: 0.9,\n                    skyboxTint: {\n                        r: 0.235294119,\n                        g: 0.2509804,\n                        b: 0.3529412,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/Standard\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_CarpetedHallway\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.3\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.7780392,\n                            g: 0.815686345,\n                            b: 0.9913726,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 60.0000038,\n                            y: 0.0,\n                            z: 25.9999962\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.428235322,\n                            g: 0.4211765,\n                            b: 0.3458824,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 180.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: 0.0,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.274509817,\n                    g: 0.274509817,\n                    b: 0.31764707,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.03529412,\n                    g: 0.03529412,\n                    b: 0.08627451,\n                    a: 1.0\n                }\n            },\n            \"c504347a-c96d-4505-853b-87b484acff9a\": {\n                name: \"NightSky\",\n                guid: \"c504347a-c96d-4505-853b-87b484acff9a\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.0196078438,\n                        g: 0.0117647061,\n                        b: 0.0431372561,\n                        a: 1.0\n                    },\n                    fogDensity: 0.006,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.3019608,\n                        g: 0.3019608,\n                        b: 0.6039216,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.0,\n                    skyboxTint: {\n                        r: 1.0,\n                        g: 1.0,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/NightSky\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Mountains\",\n                    skyboxCubemap: \"nightsky\",\n                    reflectionCubemap: \"milkyway_reflection\",\n                    reflectionIntensity: 3.0\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 1.02352941,\n                            g: 0.7647059,\n                            b: 0.929411769,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 65.0,\n                            y: 0.0,\n                            z: 25.9999981\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.0,\n                            g: 0.0,\n                            b: 0.0,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: 0.0,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.08235294,\n                    g: 0.0470588244,\n                    b: 0.184313729,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.0,\n                    g: 0.0,\n                    b: 0.0,\n                    a: 1.0\n                }\n            },\n            \"96cf6f36-47b6-44f4-bdbf-63be2ddac909\": {\n                name: \"Space\",\n                guid: \"96cf6f36-47b6-44f4-bdbf-63be2ddac909\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 1.0\n                    },\n                    fogDensity: 0.0,\n                    fogStartDistance: 5.0,\n                    fogEndDistance: 20.0,\n                    clearColor: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.227450982,\n                        g: 0.20784314,\n                        b: 0.360784322,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.0,\n                    skyboxTint: {\n                        r: 1.0,\n                        g: 1.0,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/Space\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Arena\",\n                    skyboxCubemap: \"milkyway_PNG\",\n                    reflectionCubemap: \"milkyway_reflection\",\n                    reflectionIntensity: 3.0\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 1.16000009,\n                            g: 0.866666734,\n                            b: 0.866666734,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 30.0000019,\n                            y: 39.9999962,\n                            z: 50.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.0,\n                            g: 0.0,\n                            b: 0.0,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 20.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.0,\n                    g: 0.0,\n                    b: 0.0,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.121568628,\n                    g: 0.03529412,\n                    b: 0.172549024,\n                    a: 1.0\n                }\n            },\n            \"e2e72b76-d443-4721-97e6-f3d49fe98dda\": {\n                name: \"DressForm\",\n                guid: \"e2e72b76-d443-4721-97e6-f3d49fe98dda\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.172549024,\n                        g: 0.180392161,\n                        b: 0.243137255,\n                        a: 1.0\n                    },\n                    fogDensity: 0.007,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.219607845,\n                        g: 0.227450982,\n                        b: 0.31764707,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.4117647,\n                        g: 0.3529412,\n                        b: 0.596078455,\n                        a: 1.0\n                    },\n                    skyboxExposure: 0.61,\n                    skyboxTint: {\n                        r: 0.458823532,\n                        g: 0.5137255,\n                        b: 0.7882353,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/DressForm\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_LivingRoom\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.3\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 1.1152941,\n                            g: 0.917647064,\n                            b: 0.7764706,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 7.0\n                        },\n                        rotation: {\n                            x: 50.0,\n                            y: 41.9999962,\n                            z: 25.9999924\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.356862754,\n                            g: 0.3509804,\n                            b: 0.2882353,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 227.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: 0.0,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.34117648,\n                    g: 0.345098048,\n                    b: 0.4509804,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.09411765,\n                    g: 0.105882354,\n                    b: 0.1764706,\n                    a: 1.0\n                }\n            },\n            \"ab080511-e465-4a6d-8587-53bf495af68b\": {\n                name: \"Pedestal\",\n                guid: \"ab080511-e465-4a6d-8587-53bf495af68b\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.172549024,\n                        g: 0.180392161,\n                        b: 0.243137255,\n                        a: 1.0\n                    },\n                    fogDensity: 0.007,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.219607845,\n                        g: 0.227450982,\n                        b: 0.31764707,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.4117647,\n                        g: 0.3529412,\n                        b: 0.596078455,\n                        a: 1.0\n                    },\n                    skyboxExposure: 0.61,\n                    skyboxTint: {\n                        r: 0.458823532,\n                        g: 0.5137255,\n                        b: 0.7882353,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/Pedestal\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_LivingRoom\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 1.0\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 1.1152941,\n                            g: 0.917647064,\n                            b: 0.7764706,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 7.0\n                        },\n                        rotation: {\n                            x: 50.0,\n                            y: 41.9999962,\n                            z: 25.9999924\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.356862754,\n                            g: 0.3509804,\n                            b: 0.2882353,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 227.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: 0.0,\n                widgetHome: {\n                    x: 0.0,\n                    y: 9.675,\n                    z: 5.0\n                },\n                skyboxColorA: {\n                    r: 0.34117648,\n                    g: 0.345098048,\n                    b: 0.4509804,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.09411765,\n                    g: 0.105882354,\n                    b: 0.1764706,\n                    a: 1.0\n                }\n            },\n            \"ab080511-e565-4a6d-8587-53bf495af68b\": {\n                name: \"Snowman\",\n                guid: \"ab080511-e565-4a6d-8587-53bf495af68b\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.6509804,\n                        g: 0.7254902,\n                        b: 0.8745098,\n                        a: 1.0\n                    },\n                    fogDensity: 0.005,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.6509804,\n                        g: 0.7019608,\n                        b: 0.870588243,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.7294118,\n                        g: 0.7294118,\n                        b: 0.7294118,\n                        a: 1.0\n                    },\n                    skyboxExposure: 0.95,\n                    skyboxTint: {\n                        r: 0.75686276,\n                        g: 0.819607854,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/Snowman\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_PaddedCell\",\n                    skyboxCubemap: \"snowysky\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.3\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.241451,\n                            g: 0.234078437,\n                            b: 0.3465098,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 58.0,\n                            y: 315.999969,\n                            z: 50.0000038\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.410980433,\n                            g: 0.4956863,\n                            b: 0.65882355,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 8.0\n                        },\n                        rotation: {\n                            x: 40.0,\n                            y: 143.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: 0.0,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.4627451,\n                    g: 0.5647059,\n                    b: 0.7058824,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.7607843,\n                    g: 0.8156863,\n                    b: 0.972549,\n                    a: 1.0\n                }\n            },\n            \"36e65e4f-17d7-41ef-834a-e525db0b9888\": {\n                name: \"PinkLemonade\",\n                guid: \"36e65e4f-17d7-41ef-834a-e525db0b9888\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 1.0,\n                        g: 0.5514706,\n                        b: 0.9319472,\n                        a: 1.0\n                    },\n                    fogDensity: 0.025,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.827451,\n                        g: 0.368627459,\n                        b: 0.34117648,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 1.0,\n                        g: 0.9019608,\n                        b: 0.854901969,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.0,\n                    skyboxTint: {\n                        r: 0.827451,\n                        g: 0.368627459,\n                        b: 0.34117648,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDustDim\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"gradientblue\",\n                    reflectionIntensity: 0.0\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.0,\n                            g: 0.0,\n                            b: 0.0,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 318.189667,\n                            y: 116.565048,\n                            z: 116.565048\n                        },\n                        type: \"Directional\",\n                        range: 0.0,\n                        spotAngle: 0.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.5,\n                            g: 0.28039217,\n                            b: 0.3156863,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        type: \"Directional\",\n                        range: 0.0,\n                        spotAngle: 0.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 80.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 1.0,\n                    g: 0.882352948,\n                    b: 0.65882355,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.858823538,\n                    g: 0.294117659,\n                    b: 0.3647059,\n                    a: 1.0\n                }\n            },\n            \"a9bc2bc8-6d86-4cda-82a9-283e0f3977ac\": {\n                name: \"Pistachio\",\n                guid: \"a9bc2bc8-6d86-4cda-82a9-283e0f3977ac\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.2784314,\n                        g: 0.5686275,\n                        b: 0.458823532,\n                        a: 1.0\n                    },\n                    fogDensity: 0.015,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.9558824,\n                        g: 0.6708847,\n                        b: 0.513083935,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.610186,\n                        g: 0.838235259,\n                        b: 0.75194633,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.0,\n                    skyboxTint: {\n                        r: 0.797,\n                        g: 0.616,\n                        b: 0.755,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDustDim\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"gradientblue\",\n                    reflectionIntensity: 0.3\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.209818333,\n                            g: 0.242647052,\n                            b: 0.171280265,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 41.810318,\n                            y: 116.565048,\n                            z: 243.434937\n                        },\n                        type: \"Directional\",\n                        range: 0.0,\n                        spotAngle: 0.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.977941155,\n                            g: 0.506417,\n                            b: 0.438635379,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        type: \"Directional\",\n                        range: 0.0,\n                        spotAngle: 0.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 50.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 1.0,\n                    g: 0.5176471,\n                    b: 0.3529412,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.458823532,\n                    g: 0.78039217,\n                    b: 0.5529412,\n                    a: 1.0\n                }\n            },\n            \"e65cde1a-a177-4bfb-b93f-f673c99a32bc\": {\n                name: \"Illustrative\",\n                guid: \"e65cde1a-a177-4bfb-b93f-f673c99a32bc\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 1.0,\n                        g: 1.0,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    fogDensity: 0.0125,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.7019608,\n                        g: 0.7019608,\n                        b: 0.7019608,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 1.0,\n                        g: 1.0,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    skyboxExposure: 0.0,\n                    skyboxTint: {\n                        r: 0.625,\n                        g: 0.625,\n                        b: 0.625,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDustDim\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"\",\n                    reflectionIntensity: 0.0\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.0,\n                            g: 0.0,\n                            b: 0.0,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 0.0,\n                            y: 180.0,\n                            z: 180.0\n                        },\n                        type: \"Directional\",\n                        range: 0.0,\n                        spotAngle: 0.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.0,\n                            g: 0.0,\n                            b: 0.0,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        type: \"Directional\",\n                        range: 0.0,\n                        spotAngle: 0.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 100.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.7647059,\n                    g: 0.7647059,\n                    b: 0.7647059,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.623529434,\n                    g: 0.623529434,\n                    b: 0.623529434,\n                    a: 1.0\n                }\n            },\n            \"580b4529-ac50-4fe9-b8d2-635765a14893\": {\n                name: \"Black\",\n                guid: \"580b4529-ac50-4fe9-b8d2-635765a14893\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.0196078438,\n                        g: 0.0196078438,\n                        b: 0.0196078438,\n                        a: 1.0\n                    },\n                    fogDensity: 0.0,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.392156869,\n                        g: 0.392156869,\n                        b: 0.392156869,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.0,\n                    skyboxTint: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientDust\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.3\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.7780392,\n                            g: 0.815686345,\n                            b: 0.9913726,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 60.0000038,\n                            y: 0.0,\n                            z: 25.9999962\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.428235322,\n                            g: 0.4211765,\n                            b: 0.3458824,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 180.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 100.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.0,\n                    g: 0.0,\n                    b: 0.0,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.0,\n                    g: 0.0,\n                    b: 0.0,\n                    a: 1.0\n                }\n            },\n            \"9b89b0a4-c41e-4b78-82a1-22f10a238357\": {\n                name: \"White\",\n                guid: \"9b89b0a4-c41e-4b78-82a1-22f10a238357\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 1.0,\n                        g: 1.0,\n                        b: 1.0,\n                        a: 1.0\n                    },\n                    fogDensity: 0.0,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.784313738,\n                        g: 0.784313738,\n                        b: 0.784313738,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.392156869,\n                        g: 0.392156869,\n                        b: 0.392156869,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.0,\n                    skyboxTint: {\n                        r: 0.0,\n                        g: 0.0,\n                        b: 0.0,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientGrid\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.4\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 0.7780392,\n                            g: 0.815686345,\n                            b: 0.9913726,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 60.0000038,\n                            y: 0.0,\n                            z: 25.9999962\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.428235322,\n                            g: 0.4211765,\n                            b: 0.3458824,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 180.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 100.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.784313738,\n                    g: 0.784313738,\n                    b: 0.784313738,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.784313738,\n                    g: 0.784313738,\n                    b: 0.784313738,\n                    a: 1.0\n                }\n            },\n            \"0ca88298-e5e8-4e94-aad8-4b4f6c80ae52\": {\n                name: \"Blue\",\n                guid: \"0ca88298-e5e8-4e94-aad8-4b4f6c80ae52\",\n                renderSettings: {\n                    fogEnabled: true,\n                    fogColor: {\n                        r: 0.6313726,\n                        g: 0.7137255,\n                        b: 0.894117653,\n                        a: 1.0\n                    },\n                    fogDensity: 0.005,\n                    fogStartDistance: 0.0,\n                    fogEndDistance: 0.0,\n                    clearColor: {\n                        r: 0.270588249,\n                        g: 0.309803933,\n                        b: 0.470588237,\n                        a: 1.0\n                    },\n                    ambientColor: {\n                        r: 0.203921571,\n                        g: 0.294117659,\n                        b: 0.368627459,\n                        a: 1.0\n                    },\n                    skyboxExposure: 1.46,\n                    skyboxTint: {\n                        r: 0.4627451,\n                        g: 0.5294118,\n                        b: 0.698039234,\n                        a: 1.0\n                    },\n                    environmentPrefab: \"EnvironmentPrefabs/AmbientGrid_Blue\",\n                    environmentReverbZone: \"EnvironmentAudio/ReverbZone_Room\",\n                    skyboxCubemap: \"gradientblue\",\n                    reflectionCubemap: \"threelight_reflection\",\n                    reflectionIntensity: 0.8\n                },\n                lights: [\n                    {\n                        color: {\n                            r: 1.5533334,\n                            g: 1.40666676,\n                            b: 1.77333343,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 60.0000038,\n                            y: 0.0,\n                            z: 25.9999962\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: true\n                    },\n                    {\n                        color: {\n                            r: 0.271215677,\n                            g: 0.2667451,\n                            b: 0.219058827,\n                            a: 1.0\n                        },\n                        position: {\n                            x: 0.0,\n                            y: 0.0,\n                            z: 0.0\n                        },\n                        rotation: {\n                            x: 40.0000038,\n                            y: 180.0,\n                            z: 220.0\n                        },\n                        type: \"Directional\",\n                        range: 5.0,\n                        spotAngle: 30.0,\n                        shadowsEnabled: false\n                    }\n                ],\n                teleportBoundsHalfWidth: 100.0,\n                controllerXRayHeight: -1E+09,\n                widgetHome: {\n                    x: 0.0,\n                    y: 0.0,\n                    z: 0.0\n                },\n                skyboxColorA: {\n                    r: 0.180392161,\n                    g: 0.235294119,\n                    b: 0.4117647,\n                    a: 1.0\n                },\n                skyboxColorB: {\n                    r: 0.356862754,\n                    g: 0.392156869,\n                    b: 0.6,\n                    a: 1.0\n                }\n            }\n        }[guid];\n    }\n\n    public async loadGltf(url: string, loadEnvironment : boolean) {\n        const sceneGltf = await this.gltfLoader.loadAsync(url);\n        this.setupSketchMetaData(sceneGltf.scene);\n\n        if (loadEnvironment) {\n            const guid = this.sketchMetadata?.EnvironmentGuid;\n            if (guid) {\n                const envUrl = new URL(`${guid}/${guid}.glb`, this.environmentPath);\n                const envGltf = await this.gltfLoader.loadAsync(envUrl.toString());\n                sceneGltf.scene.add(envGltf.scene);\n            }\n        }\n        this.loadedModel = sceneGltf.scene;\n        this.initializeScene();\n    }\n\n    public generateGradientSky(colorA: THREE.Color, colorB: THREE.Color, direction : THREE.Vector3)\n    {\n        const canvas = document.createElement('canvas');\n        canvas.width = 2;\n        canvas.height = 512;\n        const context = canvas.getContext('2d');\n        if (context == null) return null;\n\n        const gradient = context.createLinearGradient(0, 0, 0, 512);\n        gradient.addColorStop(0, colorA.getStyle());\n        gradient.addColorStop(1, colorB.getStyle());\n        context.fillStyle = gradient;\n        context.fillRect(0, 0, 2, 512);\n\n        const texture = new THREE.CanvasTexture(canvas);\n        texture.wrapS = THREE.RepeatWrapping;\n        texture.wrapT = THREE.ClampToEdgeWrapping;\n        const material = new THREE.MeshBasicMaterial({ map: texture, side: THREE.BackSide });\n\n        const geometry = new THREE.SphereGeometry(500, 64, 64);\n        const skybox = new THREE.Mesh(geometry, material);\n        const defaultUp = new THREE.Vector3(0, 1, 0);\n        const quaternion = new THREE.Quaternion().setFromUnitVectors(defaultUp, direction);\n        skybox.applyQuaternion(quaternion);\n        return skybox;\n    }\n\n    private setupSketchMetaData(model: Object3D<THREE.Object3DEventMap>) {\n        let sketchMetaData = new SketchMetadata(model.userData);\n        let envPreset = new EnvironmentPreset(Viewer.lookupEnvironment(sketchMetaData.EnvironmentGuid));\n        this.sketchBoundingBox = new THREE.Box3().setFromObject(model);\n        this.sketchMetadata = sketchMetaData;\n    }\n\n    private initSceneLights() {\n        if (this.sketchMetadata == undefined || this.sketchMetadata == null) {return}\n        var lights = new THREE.Group();\n    //     lights.add(new THREE.DirectionalLight(this.sketchMetadata., 1.0));\n        this.loadedModel?.add(lights);\n    }\n\n    private initSceneBackground() {\n        if (this.sketchMetadata == undefined || this.sketchMetadata == null) {return}\n        if (this.sketchMetadata.UseGradient) {\n            var sky = this.generateGradientSky(\n                this.sketchMetadata.SkyColorA,\n                this.sketchMetadata.SkyColorB,\n                this.sketchMetadata.SkyGradientDirection\n            );\n            if (sky !== null) {\n                this.loadedModel?.add(sky as Object3D<THREE.Object3DEventMap>);\n            }\n        }\n        else {\n            this.scene.background = this.sceneColor;\n        }\n    }\n\n\n}"],"names":[],"version":3,"file":"icosa-viewer.d.ts.map"}